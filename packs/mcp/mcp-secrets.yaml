name: "MCP Secrets & Credentials"
description: "Block MCP tool access to credential files, sensitive directories, and database URIs"
version: "1.0.0"
author: "AgentShield Security Research"

blocked_resources:
  - "file:///home/*/.ssh/**"
  - "file:///root/.ssh/**"
  - "file:///home/*/.aws/**"
  - "file:///root/.aws/**"
  - "file:///home/*/.gnupg/**"
  - "file:///root/.gnupg/**"

rules:
  # === BLOCK: SSH key directory access ===
  - id: mcp-sec-block-ssh-access
    match:
      tool_name_any:
        - "read_file"
        - "write_file"
        - "cat_file"
        - "create_file"
        - "edit_file"
        - "write_to_file"
      argument_patterns:
        path: "**/.ssh/**"
    decision: "BLOCK"
    reason: "Access to SSH key directories is blocked."

  # === BLOCK: AWS credential access ===
  - id: mcp-sec-block-aws-access
    match:
      tool_name_any:
        - "read_file"
        - "write_file"
        - "cat_file"
        - "create_file"
        - "edit_file"
        - "write_to_file"
      argument_patterns:
        path: "**/.aws/**"
    decision: "BLOCK"
    reason: "Access to AWS credential directories is blocked."

  # === BLOCK: GPG key access ===
  - id: mcp-sec-block-gnupg-access
    match:
      tool_name_any:
        - "read_file"
        - "write_file"
        - "cat_file"
        - "create_file"
      argument_patterns:
        path: "**/.gnupg/**"
    decision: "BLOCK"
    reason: "Access to GPG key directories is blocked."

  # === BLOCK: Kubernetes config access ===
  - id: mcp-sec-block-kube-access
    match:
      tool_name_any:
        - "read_file"
        - "write_file"
        - "cat_file"
        - "create_file"
      argument_patterns:
        path: "**/.kube/**"
    decision: "BLOCK"
    reason: "Access to Kubernetes config is blocked."

  # === BLOCK: Cloud CLI credentials ===
  - id: mcp-sec-block-gcloud-access
    match:
      tool_name_any:
        - "read_file"
        - "write_file"
        - "cat_file"
        - "create_file"
      argument_patterns:
        path: "**/.config/gcloud/**"
    decision: "BLOCK"
    reason: "Access to Google Cloud credentials is blocked."

  # === BLOCK: .env file reads ===
  - id: mcp-sec-block-dotenv-read
    match:
      tool_name_any:
        - "read_file"
        - "cat_file"
      argument_patterns:
        path: "**/.env"
    decision: "AUDIT"
    reason: ".env file access flagged for review â€” may contain secrets."

  # === BLOCK: Git credentials ===
  - id: mcp-sec-block-git-credentials
    match:
      tool_name_any:
        - "read_file"
        - "cat_file"
      argument_patterns:
        path: "**/.git-credentials"
    decision: "BLOCK"
    reason: "Git credential file access is blocked."

resource_rules:
  # === BLOCK: Database URI access ===
  - id: mcp-sec-block-mysql-uri
    match:
      scheme: "mysql"
    decision: "BLOCK"
    reason: "Direct MySQL database access via MCP is blocked."

  - id: mcp-sec-block-postgres-uri
    match:
      scheme: "postgres"
    decision: "BLOCK"
    reason: "Direct PostgreSQL database access via MCP is blocked."

  - id: mcp-sec-block-redis-uri
    match:
      scheme: "redis"
    decision: "BLOCK"
    reason: "Direct Redis access via MCP is blocked."

  - id: mcp-sec-block-mongodb-uri
    match:
      scheme: "mongodb"
    decision: "BLOCK"
    reason: "Direct MongoDB access via MCP is blocked."

  # === BLOCK: Sensitive file URI patterns ===
  - id: mcp-sec-block-ssh-uri
    match:
      uri_pattern: "file:///**/.ssh/**"
    decision: "BLOCK"
    reason: "Resource read of SSH key files is blocked."

  - id: mcp-sec-block-aws-uri
    match:
      uri_pattern: "file:///**/.aws/**"
    decision: "BLOCK"
    reason: "Resource read of AWS credential files is blocked."
