id: "destructive-ops/resource-exhaustion/fork-bomb"
version: "1.0.0"
kingdom: "Destructive Operations"
kingdom_id: 1
category: "Resource Exhaustion"
category_id: "1.3"
name: "Fork Bomb"
risk_level: "critical"

abstract: |
  A command spawns processes recursively until system resources are
  exhausted, causing a denial-of-service condition.

explanation: |
  Fork bombs create an exponentially growing number of processes that
  consume all available PIDs, CPU, and memory. Classic examples:
  - `:(){ :|:& };:` (bash fork bomb)
  - `fork while true` patterns in various languages
  - `perl -e 'fork while 1'`

  AI agents are unlikely to generate these intentionally, but prompt
  injection attacks could embed fork bombs in agent instructions.

recommendation: |
  - Block known fork bomb patterns via regex and structural analysis.
  - Set process limits (ulimit) in the agent execution environment.
  - Use cgroups to limit resource consumption of agent-spawned processes.

examples:
  bad:
    - ":(){ :|:& };:"
    - "perl -e 'fork while 1'"
    - "python3 -c 'import os; [os.fork() for _ in iter(int, 1)]'"
  good:
    - "ulimit -u 100"
    - "nproc"

compliance:
  owasp-llm-2025: ["LLM05", "LLM06", "LLM10"]

references:
  mitre_attack: ["T1499"]
  cwe: ["CWE-400"]
  external:
    - title: "MITRE ATT&CK: Endpoint Denial of Service"
      url: "https://attack.mitre.org/techniques/T1499/"

analyzers: ["regex", "structural"]
related_rules: ["ts-block-fork-bomb"]
