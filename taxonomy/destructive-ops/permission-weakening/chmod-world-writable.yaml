id: "destructive-ops/permission-weakening/chmod-world-writable"
version: "1.0.0"
kingdom: "Destructive Operations"
kingdom_id: 1
category: "Permission Weakening"
category_id: "1.4"
name: "World-Writable Permissions"
risk_level: "high"

abstract: |
  A command sets world-writable permissions (777) on root or system paths,
  removing all file access protections.

explanation: |
  `chmod 777` makes files readable, writable, and executable by all users.
  When applied to system directories, this eliminates access controls and
  enables any process to modify critical system files:
  - `chmod 777 /` — all files on the system become world-writable
  - `chmod -R 777 /etc` — recursively weakens all config permissions

  AI agents may do this when troubleshooting "permission denied" errors,
  applying an overly broad fix instead of targeted permission changes.

recommendation: |
  - Block chmod 777 on root or system directories.
  - Suggest targeted permission fixes (e.g., chmod 644 for files, 755 for dirs).
  - Use chown to fix ownership issues instead of weakening permissions.

examples:
  bad:
    - "chmod 777 /"
    - "chmod -R 777 /etc"
    - "sudo chmod 777 /var"
  good:
    - "chmod 755 ./script.sh"
    - "chmod 644 ./config.yaml"

compliance:
  owasp-llm-2025: ["LLM05", "LLM06"]

references:
  mitre_attack: ["T1222"]
  cwe: ["CWE-732"]
  external:
    - title: "MITRE ATT&CK: File and Directory Permissions Modification"
      url: "https://attack.mitre.org/techniques/T1222/"

analyzers: ["regex", "structural"]
related_rules: ["ts-block-chmod-777", "ts-block-chmod-recursive-sensitive"]
