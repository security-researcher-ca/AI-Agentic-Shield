id: "destructive-ops/disk-ops/disk-overwrite"
version: "1.0.0"
kingdom: "Destructive Operations"
kingdom_id: 1
category: "Disk & Partition Operations"
category_id: "1.2"
name: "Disk Overwrite"
risk_level: "critical"

abstract: |
  A command uses dd or similar tool to overwrite disk data with zeros
  or random bytes, causing irreversible data loss.

explanation: |
  The `dd` command can write directly to block devices, bypassing the
  filesystem entirely. Common destructive patterns:
  - `dd if=/dev/zero of=/dev/sda` — fills disk with zeros
  - `dd if=/dev/urandom of=/dev/sda` — fills disk with random data
  - `dd if=/dev/random of=/dev/sda` — similar but slower

  AI agents may generate these commands when confused about disk
  operations or when trying to "securely erase" data without
  understanding the consequences.

recommendation: |
  - Block all dd commands that write to block devices from /dev/zero or /dev/urandom.
  - Require explicit user approval for any dd operation targeting /dev/*.
  - Suggest safer alternatives like shred for secure file deletion.

examples:
  bad:
    - "dd if=/dev/zero of=/dev/sda"
    - "sudo dd if=/dev/urandom of=/dev/nvme0n1"
    - "dd if=/dev/random of=/dev/sda bs=1M"
  good:
    - "dd if=image.iso of=/dev/sdb bs=4M"
    - "dd if=/dev/zero of=./test.img bs=1M count=100"

compliance:
  owasp-llm-2025: ["LLM05", "LLM06"]

references:
  mitre_attack: ["T1561"]
  cwe: ["CWE-400"]
  external:
    - title: "MITRE ATT&CK: Disk Wipe"
      url: "https://attack.mitre.org/techniques/T1561/"

analyzers: ["regex", "structural"]
related_rules: ["ts-block-dd-zero"]
