id: "destructive-ops/disk-ops/filesystem-format"
version: "1.0.0"
kingdom: "Destructive Operations"
kingdom_id: 1
category: "Disk & Partition Operations"
category_id: "1.2"
name: "Filesystem Format"
risk_level: "critical"

abstract: |
  A command creates a new filesystem on a disk or partition, destroying
  all existing data on that device.

explanation: |
  The `mkfs` family of commands (mkfs.ext4, mkfs.xfs, etc.) formats
  a partition or disk, erasing all data. AI agents may invoke these
  when misinterpreting instructions about disk setup or when trying
  to "reset" a storage device.

recommendation: |
  - Block all mkfs commands unconditionally in agent context.
  - Filesystem creation should always be a manual human operation.
  - Suggest mounting existing filesystems instead.

examples:
  bad:
    - "mkfs.ext4 /dev/sda1"
    - "sudo mkfs -t xfs /dev/nvme0n1p1"
    - "mkfs.btrfs /dev/sdb"
  good:
    - "mount /dev/sda1 /mnt"
    - "df -h"

compliance:
  owasp-llm-2025: ["LLM05", "LLM06"]

references:
  mitre_attack: ["T1561"]
  cwe: ["CWE-400"]
  external:
    - title: "MITRE ATT&CK: Disk Wipe"
      url: "https://attack.mitre.org/techniques/T1561/"

analyzers: ["regex", "structural"]
related_rules: ["ts-block-mkfs"]
