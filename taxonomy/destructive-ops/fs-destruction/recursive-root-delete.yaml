id: "destructive-ops/fs-destruction/recursive-root-delete"
version: "1.0.0"
kingdom: "Destructive Operations"
kingdom_id: 1
category: "Filesystem Destruction"
category_id: "1.1"
name: "Recursive Root Delete"
risk_level: "critical"

abstract: |
  A command recursively deletes files starting from the filesystem root,
  causing irreversible destruction of the entire operating system and data.

explanation: |
  Commands like `rm -rf /` or `rm --recursive --force /` will attempt to
  delete every file on the system. Modern systems have `--no-preserve-root`
  safeguards, but many variants bypass this:
  - `rm -rf /` (direct root delete)
  - `rm -rf /*` (glob expansion bypasses --no-preserve-root)
  - `rm --recursive --force /` (long flag variants)
  - `sudo rm -rf /` (with privilege escalation)
  - `rm -r -f /` (separated short flags)

  AI agents may generate these commands during cleanup tasks or when
  confused by ambiguous instructions like "remove everything" or
  "clean up the project."

recommendation: |
  - Never allow recursive delete on root or system directories.
  - Use sandbox mode to preview destructive operations before execution.
  - Restrict delete scope to project directories only.
  - Prefer `trash` or `trash-put` over `rm` for reversible deletes.
  - Validate target paths against an allowlist of safe directories.

examples:
  bad:
    - "rm -rf /"
    - "rm --recursive --force /"
    - "sudo rm -rf / --no-preserve-root"
    - "rm -rf /*"
    - "rm -r -f /"
  good:
    - "rm -rf ./node_modules"
    - "rm -rf /tmp/build-cache"
    - "trash ./old-directory"

compliance:
  owasp-llm-2025: ["LLM05", "LLM06"]

references:
  mitre_attack: ["T1485"]
  cwe: ["CWE-73"]
  external:
    - title: "MITRE ATT&CK: Data Destruction"
      url: "https://attack.mitre.org/techniques/T1485/"
    - title: "AIShellJack: Prompt Injection on AI Coding Editors"
      url: "https://arxiv.org/abs/2509.22040"

analyzers: ["regex", "structural", "semantic"]
related_rules: ["ts-block-rm-root", "ts-block-rm-force-recursive"]
