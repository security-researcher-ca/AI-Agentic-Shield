id: "destructive-ops/fs-destruction/system-directory-delete"
version: "1.0.0"
kingdom: "Destructive Operations"
kingdom_id: 1
category: "Filesystem Destruction"
category_id: "1.1"
name: "System Directory Delete"
risk_level: "critical"

abstract: |
  A command recursively deletes critical system directories such as /etc,
  /usr, /var, /boot, /sys, or /proc, causing system instability or failure.

explanation: |
  While deleting the filesystem root is the most extreme case, targeting
  specific system directories is equally dangerous:
  - `/etc` — system configuration (deleting breaks boot, networking, services)
  - `/usr` — installed programs and libraries
  - `/var` — logs, databases, mail spools
  - `/boot` — kernel and bootloader (deleting prevents reboot)
  - `/sys`, `/proc` — kernel interfaces

  AI agents may target these directories when misinterpreting instructions
  like "remove old config files" or "clean up /etc."

recommendation: |
  - Maintain a hardcoded list of protected system directories.
  - Block recursive delete on any path matching protected directories.
  - Use sandbox mode for any delete operation outside project scope.
  - Suggest safer alternatives (e.g., targeted file removal vs directory wipe).

examples:
  bad:
    - "rm -rf /etc"
    - "sudo rm -rf /usr/local"
    - "rm -rf /var/log"
    - "rm -rf /boot"
  good:
    - "rm -rf ./dist"
    - "rm -rf /tmp/test-output"

compliance:
  owasp-llm-2025: ["LLM05", "LLM06"]

references:
  mitre_attack: ["T1485"]
  cwe: ["CWE-73"]
  external:
    - title: "MITRE ATT&CK: Data Destruction"
      url: "https://attack.mitre.org/techniques/T1485/"

analyzers: ["regex", "structural"]
related_rules: ["ts-block-rm-force-recursive"]
