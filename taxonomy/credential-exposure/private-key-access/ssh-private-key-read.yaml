id: "credential-exposure/private-key-access/ssh-private-key-read"
version: "1.0.0"
kingdom: "Credential & Secret Exposure"
kingdom_id: 2
category: "Private Key Access"
category_id: "2.1"
name: "SSH Private Key Read"
risk_level: "critical"

abstract: |
  A command reads or copies SSH private key files, enabling impersonation
  of the key owner for remote access.

explanation: |
  SSH private keys (id_rsa, id_ed25519, id_ecdsa, etc.) stored in ~/.ssh/
  provide passwordless authentication to remote systems. Reading these files
  allows an attacker to:
  - Impersonate the user on any system that trusts the key
  - Access git repositories (GitHub, GitLab) via SSH
  - Pivot to production servers

  AI agents may access these files when trying to "check SSH configuration"
  or "debug connection issues."

recommendation: |
  - Block all read access to ~/.ssh/id_* and ~/.ssh/private* files.
  - Use protected_paths configuration to cover SSH key directories.
  - Suggest using ssh-agent instead of direct key file access.
  - Never display private key contents in agent output.

examples:
  bad:
    - "cat ~/.ssh/id_rsa"
    - "cat ~/.ssh/id_ed25519"
    - "cp ~/.ssh/id_rsa /tmp/"
    - "base64 ~/.ssh/id_rsa"
  good:
    - "cat ~/.ssh/config"
    - "ssh-add -l"
    - "cat ~/.ssh/id_rsa.pub"

compliance:
  owasp-llm-2025: ["LLM02", "LLM06"]

references:
  mitre_attack: ["T1552.004"]
  cwe: ["CWE-522"]
  external:
    - title: "MITRE ATT&CK: Unsecured Credentials: Private Keys"
      url: "https://attack.mitre.org/techniques/T1552/004/"

analyzers: ["regex", "structural", "dataflow"]
related_rules: ["sec-block-ssh-private"]
